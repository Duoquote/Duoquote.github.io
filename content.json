{"pages":[],"posts":[{"title":"Web Scraping Nasıl Yapılır?","text":"Web Scraping, her ne kadar basit gibi gözükse de, korkunç birçok tarafı vardır. Birbirinden farklı birçok websitesi, birçok farklı teknoloji var. Bu paylaşımda elimden geldiğince Web Scraping konusunu sizlere aktarmaya çalışacağım. Web Scraping nedir?Bunun zaten ne olduğunu biliyorsanız sizi alt kısımlara alabilirim :). Web Scraping, belirlenen web sayfasından veri almaktır. Tabii ki sadece veriyi almak değil, bu veriyi derlemek, işe yarar hale getirmek de bir parçasıdır. Hangi programlama dili kullanılmalı?Bu konuda seçenekleriniz oldukça geniş. Benim tercihim python dilinden yana. Özellikle jupyter notebook kullanarak çok seri bir şekilde yazdığınız kodu test ederek ilerleyebilirsiniz. Python dışında aşağı yukarı her dil ile veri toplayabilirsiniz. Selenium diye bir sistem var. Bu sistemin de veri almada kullanılabileceğini düşünürsek alternatif olarak kullanabileceğiniz diller arasında; Node.JS Java (Selenium) JavaScript (Chrome Kullanarak) PHP C C# Bash (Evet bash kullanarak bile yapabilirsiniz) Bunlar sadece birkaç örnek, mantıken internetten veri alabildiğiniz her dil veya sistem ile web scraping yapabilirsiniz. Bir website’den veri almayı deneyelim;Bu örnek için ben python kullanacağım, sisteminizde python ve pip kurulu olduğunu varsayaraktan konsol açıp requests modülünü kurmanız gerekmektedir. 1pip install requests Veri almaİlk olarak requests modülünü projemize dahil edelim. 1import requests Basit bir GET isteği göndermek için requests modülünden get fonksiyonunu kullanabiliriz. Örnekte ben kendi siteme bir GET isteği yolluyorum. 1data = requests.get(\"https://guvendegirmenci.com\") Şu ana kadar veriyi aldık iyi güzel de aldığımız veriyi nasıl görüntüleyeceğiz? Aldığımız veriyi text, yani yazı formatında görüntüleyebiliriz: 1print(data.text) Ya da byte olarak görüntüleyebiliriz: 1print(data.content) Ya da aldığınız veri JSON formatında bir veri ise python dictionary formatında alabilirsiniz. Örnekte kendi websitemde dil değiştirme özelliği için kullandığım JSON verisini kullanıyorum: 123data = requests.get(\"https://guvendegirmenci.com/data.json\")print(data.json()) Dictionary verisini düzenli görüntülemek için pprint modülünü kullanabilirsiniz, örnek: 123from pprint import pprintpprint(data.json()) Kodumuzun son hali aşağıdaki gibi bir şey olacaktır: 12345678910111213141516import requestsfrom pprint import pprintdata = requests.get(\"https://guvendegirmenci.com\")# Text verisi görüntüleprint(data.text)# Byte verisi görüntüleprint(data.content)# Sitemdeki JSON verisini almak için başka bir GET isteği yolla.data = requests.get(\"https://guvendegirmenci.com/data.json\")# JSON verisi görüntülepprint(data.json()) Programımızın çıktısı aşağıdaki gibi olacaktır, çıktı biraz uzun olduğu için … ile kısalttım: 1234567&lt;!DOCTYPE html&gt;&lt;html lang=\"TR\"&gt;&lt;head&gt;&lt;title&gt;Güven Değirmenci&lt;/title&gt;&lt;meta http...b'&lt;!DOCTYPE html&gt;&lt;html lang=\"TR\"&gt;&lt;head&gt;&lt;title&gt;G\\xc3\\xbcven De\\xc4\\x9firmenci&lt;/...{'EN': {'data': {'labels': {'about': 'about', 'blog': 'blog', 'contact': 'contact', 'discord': 'discord', 'links': 'links',... Veri bulmaİyi güzel veriyi aldık da, bu veri karman çorman, burdan bir şekilde veri elde etmemiz lazım. Bunun için kullanabileceğimiz birkaç metod mevcut. Metod 1 - BeautifulSoupEn kolay ve belki de en verimli yöntem, BeautifulSoup modülünü kullanarak aradığınızı bulmayı kolaylaştırabilirsiniz. Kullanımı eğer programlamaya yeni başlayan biriyseniz zor gelebilir ancak kodlamaya devam edin! Yapmaya çalıştığınız şeye her zaman ulaşmaya çalışın, pes etmeyin! BeautifulSoup python ile birlikte gelmemekte, bu yüzden pip ile kurmamız gerekiyor; 1pip install bs4 BeautifulSoup’u kurarken pip install beautifulsoup yazarak kurmayınız. Önceki yaptıklarımızdan biraz referans alarak, birkaç modülü hemen projemize dahil edelim: 123import requestsfrom pprint import pprintfrom bs4 import BeautifulSoup Yine basit bir GET isteği gönderelim: 1data = requests.get(\"https://guvendegirmenci.com\") Şimdi onu BeautifulSoup‘a aktaralım: 1sayfa = BeautifulSoup(data.text, \"html\") Dikkat edin, data değil de data.text‘i kullandım, data bir istek objesidir; data.text ise istekte gelmiş olan string verisini içerir. data.text yerine data.content de kullanılabilir. data.text string, data.content byte olarak veriyi içerir. Beautifulsoup bu iki tipi de kabul eder. Sayfada arama yapmak için birçok yöntemi kullanabilirsiniz. Kod olarak son halini size örnekleriyle birlikte vereyim; 12345678910111213141516171819202122232425262728293031import requestsfrom bs4 import BeautifulSoupdata = requests.get(\"https://guvendegirmenci.com\")sayfa = BeautifulSoup(data.text, \"html\")# &lt;title&gt; tagına sahip olan ilk elementini bul.print(sayfa.find(\"title\"))# &lt;p&gt; tagına sahip olan ilk elementi bul.print(sayfa.find(\"p\"))# &lt;p&gt; tagına sahip olan tüm elementleri bul. (element listesi verir)print(sayfa.findAll(\"p\"))# Herhangi bir class'a sahip olmayan &lt;a&gt; elementlerini bul.print(sayfa.findAll(\"a\", {\"class\": False}))# Herhangi bir class'a sahip olan &lt;a&gt; elementlerini bul.print(sayfa.findAll(\"a\", {\"class\": True}))# &lt;li&gt; tagına sahip olup \"nav-item\" class'ına sahip olan elementleri bul.print(sayfa.findAll(\"li\", {\"class\": \"nav-item\"}))# &lt;a&gt; tagına sahip olup \"nav-link\" class'ına sahip olan elementleri bul.print(sayfa.findAll(\"a\", {\"class\": \"nav-link\"}))# &lt;a&gt; tagına sahip olup \"href\" değeri \"https://stackoverflow.com/story/duoquote\"# olan elementleri bul.print(sayfa.find(\"a\", {\"href\": \"https://stackoverflow.com/story/duoquote\"})) Örnekte yazdığım find ve findAll metodları gayet klasiktir. Bunların dışında SoupSieve denen library sayesinde BeautifulSoup bizlere javascriptteki querySelector komutunda kullandığımız syntax’ı kullanmamızı sağlıyor. Burada detaya pek giremedim, sonuçta kendisi bir web standardıdır. Daha detaylı bilgi için buraya göz atabilirsiniz. Bir adım ileri, RegEx örneği.Yazılım dünyasında en sevdiğim şey, RegEx. RegEx, uzun adıyla Regular Expression, yazdığınız kurallar ile yazı içerisinde o kurallara uyan kısımları aramanıza yarar. RegEx ile bir element arayacak olsaydık; 12345678910import requests, refrom bs4 import BeautifulSoupdata = requests.get(\"https://guvendegirmenci.com\")sayfa = BeautifulSoup(data.text, \"html\")# &lt;a&gt; tagına sahip olup \"href\" değeri r\".*stackoverflow\\.com.*\" RegEx ile eşleşen# elementi bul.print(sayfa.find(\"a\", {\"href\": re.compile(r\".*stackoverflow\\.com.*\")})) Burada yazdığım RegEx kuralını parçalara ayıralım. Korkutucu gözükebilir ancak temelinde çok basit prensipleri var. r&quot;.*stackoverflow\\.com.*&quot; ilk olarak tırnak ifadelerini es geçebiliriz, python’da fonksiyona verdiğimiz bir yazı olarak hayal edin bunu, asıl regex değerimiz; .*stackoverflow\\.com.* Şimdi RegEx’te;. (nokta), herhangi bir karakter anlamına gelmekte.* (yıldız), hiç ya da sonsuz sayıda demek. Bu ikisi birleşince, .* herhangi bir karakterden hiç ya da sonsuz sayıda gibi bir ifade ortaya çıkıyor. Yani bunu bir yazı ile karşılaştıracak olsaydık, yazı bomboş olsaydı veya sonsuz karakterden oluşsaydı her daim eşleşecekti. Şimdi bunun yanına stackoverflow.com eklediğimizde, bu stackoverflow.com yazısının başlangıcında sonsuz sayıda karakter olabilir, olmaya da bilir demek. .* kısmını sonuna eklediğimizde ise, başında veya sonunda herhangi bir sayıda karakter olabilir olmaya da bilir anlamına geliyor. Yani bu duruma göre, asd__stackoverflow.com__zxc yazısı da eşlenirdi stackoverflow.com yazısı da. Daha detaylı olarak incelemek veya kurcalamak isterseniz, bahsettiğim RegEx ifadesini burada inceleyebilirsiniz. RegEx’in Web Scraping alanındaki değeri çok büyük, istediğiniz her şeyi RegEx ile bulabilmek mümkün, sınırı yok. Biraz idrak etmesi zor bir sistem, ancak bir kere öğrendiğinizde, normal şartlarda ne kadar zor bulunabilecek bir şey varsa, bunu RegEx ile ne kadar kolay bulabileceğinizi farkedebiliyorsunuz. Metod 2 - LXMLBu yine bir python örneği ancak başka bir modül kullanarak, bu modül pek güzel gelmeyebilir ancak performans söz konusu ise oldukça iyidir. LXML’i Windows’ta kurmak sıkıntı yaratabilir bu yüzden tercih etmeyebilirsiniz, benim önerim Windows’ta Subsystem for Linux özelliğini açıp Microsoft Mağaza’dan Ubuntu veya Debian kurmanız, kodu orada çalıştırmanızdır. Requests ve gereken lxml parçasını import edelim; 12import requestsfrom lxml import etree Veriyi alalım; 1data = requests.get(\"https://guvendegirmenci.com\") Sayfayı lxml’e aktaralım; 1sayfa = etree.HTML(data.content) LXML’i şahsen genel olarak xpath denen arama özelliği yüzünden kullanırım, xpath’e alıştıktan sonra BeautifulSoup ile herhangi bir şey aratmak işkence gibi geliyor, xpath BeautifulSoup’a göre biraz karmaşıktır, bir arama dilidir diyebiliriz. Xpath ile alakalı genel örneklere bu linkten ulaşabilirsiniz. Xpath ile sayfada aradıklarınızı kolayca bu şekilde bulabilirsiniz; 1234567891011121314151617181920212223242526272829303132333435# Sayfadaki tüm &lt;div&gt; taglerini bul.sayfa.xpath(\"//div\")# Sayfada class değeri \"row\"'a eşit olan tüm &lt;div&gt; elementlerini bul.# Dikkat edin \"row\" yazısı içeren vs. demedim, direk \"row\" yazan yerler,# yani \"row \" veya \"row element\" gibi değerler ile eşleşmez.sayfa.xpath(\"//div[@class='row']\")# Elementlerin \"href\" veya \"class\" gibi attribute dediğimiz yerlerdeki# verileri `.get` metodunu kullanarak istediğimiz değeri alabiliriz.print(sayfa.xpath(\"//div[@class='row']\").get(\"class\"))# Sayfada class değeri \"row\" içeren tüm div elementlerini bul.sayfa.xpath(\"//div[contains(@class, 'row')]\")# Class yerine farklı değerler de kullanabiliriz, örneğin;sayfa.xpath(\"//a[contains(@href, '#')]\")# Class değeri olarak \"post-data\" içeren div elementlerini bul,# bir alt elementi &lt;h1&gt; olan &lt;h1&gt; elementlerini seç.h1Elementleri = sayfa.xpath(\"//div[contains(@class, 'post-data')]/h1\")# Üstteki örneğin aynısı ancak farklı bir yaklaşım.divElementleri = sayfa.xpath(\"//div[contains(@class, 'post-data')]\")for div in divElems: # \"./\" kullandık, çünkü aslında bu element üstünde xpath fonksiyonunu # çalıştırsak bile yazdığımız xpath yönergeleri tüm web sayfası için # geçerlidir, şu anda bulunduğu elementin alt elementini aradığımız için # \"./\" kullanarak o elementten devam etmesini sağlayabiliriz. div.xpath(\"./h1\") # `.text` kullanarak elementtin içine yazılı olan veriyi alabiliriz. # Bunu yaparken yine [0] ile bulunan ilk elementi seçmeyi unutmayın. print(div.xpath(\"./h1\")[0].text) LXML kısmı biraz kısa olmuş olabilir ancak o konuya tam anlamıyla dalacak olsaydık büyük ihtimalle bu blog postundan daha uzun bir post paylaşmam gerekirdi. Bu tabii ki yapmayacağım demek değil :).","link":"/2020/08/09/Web-Scraping-Nasil-Yapilir/"}],"tags":[],"categories":[]}